generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Project {
  id           Int           @id @default(autoincrement())
  name         String        @unique
  repository   String        @unique // GitHub repo URL or name
  pullRequests PullRequest[]
}

model User {
  id           Int           @id @default(autoincrement())
  username     String        @unique
  pullRequests PullRequest[]
}

model Ticket {
  id           Int           @id @default(autoincrement())
  code         String        @unique // e.g. TICKET-123
  pullRequests PullRequest[]
}

model PullRequest {
  id        Int     @id @default(autoincrement())
  project   Project @relation(fields: [projectId], references: [id])
  projectId Int

  author   User @relation(fields: [authorId], references: [id])
  authorId Int

  ticket   Ticket? @relation(fields: [ticketId], references: [id])
  ticketId Int?

  branch       String
  createdAt    DateTime
  prNumber     Int
  additions    Int
  deletions    Int
  changedFiles Int
}
